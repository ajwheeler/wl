(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6070,        196]
NotebookOptionsPosition[      5648,        176]
NotebookOutlinePosition[      5986,        191]
CellTagsIndexPosition[      5943,        188]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"model", " ", "=", " ", 
  RowBox[{
   RowBox[{"Id", " ", 
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"x", "-", "x0"}], "ad"], ")"}], "2"], " ", "+", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"y", " ", "-", " ", "y0"}], "bd"], ")"}], "2"]}], "]"}]}],
       "rd"], "]"}]}], " ", "+", " ", 
   RowBox[{"Ib", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"], " ", "+", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", " ", "-", " ", "y0"}], ")"}], "2"]}], "]"}], "rb"], 
        ")"}], 
       RowBox[{"1", "/", "4"}]]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelp", " ", "=", " ", 
   RowBox[{"%", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rd", "\[Rule]", "3"}], ",", " ", 
      RowBox[{"rb", "\[Rule]", "7"}], ",", " ", 
      RowBox[{"Id", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"Ib", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"x0", " ", "\[Rule]", "0"}], ",", " ", 
      RowBox[{"y0", "\[Rule]", "0"}], ",", 
      RowBox[{"ad", "\[Rule]", " ", "1.2"}], ",", " ", 
      RowBox[{"bd", "\[Rule]", ".8"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DensityPlot", "[", 
   RowBox[{"%", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", 
      RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "20"}], ",", "20"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.654708475058448*^9, 3.654708478611229*^9}, {
   3.6547086506950703`*^9, 3.65470868156546*^9}, {3.6547089194895363`*^9, 
   3.6547090490712748`*^9}, {3.6547090801018143`*^9, 3.654709099694879*^9}, {
   3.6547091307148848`*^9, 3.65470920511908*^9}, {3.654709235514327*^9, 
   3.654709253868287*^9}, {3.654709293936596*^9, 3.654709367158894*^9}, 
   3.6547095388013906`*^9, {3.6547095812724743`*^9, 3.654709607433063*^9}, {
   3.654709640834167*^9, 3.654709654600375*^9}, {3.654709886894166*^9, 
   3.654710064658608*^9}, {3.654874135523292*^9, 3.654874218705679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y", "-", "y0"}], ")"}], "2"]}]], "rb"], ")"}], 
      RowBox[{"1", "/", "4"}]]}]], " ", "Ib"}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SqrtBox[
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "x0"}], ")"}], "2"], 
         SuperscriptBox["ad", "2"]], "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "y0"}], ")"}], "2"], 
         SuperscriptBox["bd", "2"]]}]], "rd"]}]], " ", "Id"}]}]], "Output",
 CellChangeTimes->{{3.654709251773213*^9, 3.654709254229988*^9}, {
   3.654709300467806*^9, 3.654709367459516*^9}, 3.6547095457940817`*^9, 
   3.6547095878795547`*^9, 3.654709655272829*^9, {3.654709894534343*^9, 
   3.654710065250572*^9}, 3.654874180602654*^9, {3.65487421115847*^9, 
   3.65487422017461*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"model", ",", "ad"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.654874150511065*^9, 3.6548741534219017`*^9}, {
  3.654874237990286*^9, 3.654874238493977*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SqrtBox[
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "x0"}], ")"}], "2"], 
         SuperscriptBox["ad", "2"]], "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "y0"}], ")"}], "2"], 
         SuperscriptBox["bd", "2"]]}]], "rd"]}]], " ", "Id", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "-", "x0"}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox["ad", "3"], " ", "rd", " ", 
   SqrtBox[
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"], 
      SuperscriptBox["ad", "2"]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "-", "y0"}], ")"}], "2"], 
      SuperscriptBox["bd", "2"]]}]]}]]], "Output",
 CellChangeTimes->{3.6548742389047213`*^9}]
}, Open  ]]
},
WindowSize->{814, 780},
WindowMargins->{{Automatic, -13}, {-148, Automatic}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2521, 65, 224, "Input"],
Cell[3104, 89, 1255, 37, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4396, 131, 218, 5, 32, "Input"],
Cell[4617, 138, 1015, 35, 155, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
